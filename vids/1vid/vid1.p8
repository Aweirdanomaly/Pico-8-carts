pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
function animate(frames,current)

return (current) % #frames + 1

end


function _init()

	
	frame=1
	
	hframe={1,3,9,5,7,11}
	hcurr=1
	
	bframe={32,34,36,38,40,42}
	bcurr=1
	test={}
	
	particles={}
	
	spawn_particles(rnd(140),rnd(140),0,0,3,1.8,0,1.4,{2,2,12,12}) 


end

function _update60()
	frame+=1
	test[1]=frame
	
	test[2]=hcurr
	
	if frame % 9 == 0 then
		hcurr=animate(hframe,hcurr)
 end
 
 if frame % 8  == 0 then
		bcurr=animate(bframe,bcurr)
 end
 
 if frame % 20  == 0 or frame % 30 ==0 then
		spawn_particles(rnd(140),rnd(140),0,0,10,1,0,1.20,{rnd(15)}) 
		
 end
 
 
 
 --updates
 for particle in all(particles) do
 	particle:update()
 end
 
 
 

end


function _draw()
	cls()
	background(frame)
	
	i=0
	for debug in all(test) do
	//print(debug,0,0+i,8)
	i+=6
	end
	
	
	spr(hframe[hcurr],32,60,2,2)
	spr(bframe[bcurr],60,60,2,2)
	
	
	--updates
	
	for particle in all(particles) do
 	particle:draw()
 end
end
-->8

-->8
function background(frame)
	t=frame/50
 cls()
 
 --this crazy bit loops through
 --limited background colors,
 --and changes it when the
 --screen is covered with white
 local c = 0
 rectfill(0,0,128,128,c)
 
 for i=0,8 do -- column loop
  for j=0,8 do -- row loop
      --x positions are snapped
      --to 16px columns
      local x = i*16
     
      --this number sweeps back
      --and forth from -1 to 1
      local osc1 = sin(t+i*0.1)
     
      --this number also sweeps
      --back and forth, but at
      --a different rate
      local osc2 = sin(t/4+j*0.03)
     
      --y positions are influenced
      --by one of the sweepy
      --numbers
      local y = j*16 + osc1*5
     
      --the circles' radii are
      --influenced by the other
      --sweepy number
   circfill(x, y, osc2*5, 7)
   
  end
 end
end



function spawn_particles(_x,_y,_dx,_dy,_l,_s,_g,_p,_f)
    add(particles, {
        fade=_f,
     x=_x,
     y=_y,
     dx=_dx,
     dy=_dy,
     life=_l,
     orig_life=_l,
     rad=_s,
     p=_p,
        col=12, --set to color
     grav=_g,
     draw=function(self)
         --this function takes care
         --of drawing the particle
        
         --clear the palette
         pal()
         palt()
        
         --draw the particle
         circfill(self.x,self.y,self.rad,self.col)
     end,
     update=function(self)
         --this is the update function
        
         --move the particle based on
         --the speed
         self.x+=self.dx
         self.y+=self.dy
         --and gravity
         self.dy+=self.grav
        
         --reduce the radius
         --this is set to 90%, but
         --could be altered
         self.rad*=self.p
        
         --reduce the life
         self.life-=1
        
         --set the color
         if type(self.fade)=="table" then
             --assign color from fade
             --this code works out how
             --far through the lifespan
             --the particle is and then
             --selects the color from the
             --table
             self.col=self.fade[flr(#self.fade*(self.life/self.orig_life))+1]
            else
                --just use a fixed color
                self.col=self.fade            
         end
         
         --if the dust has exceeded
         --its lifespan, delete it
         --from the table
         if self.life<0 then
             del(particles,self)
        end
     end
 })
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000008000000000000000800000000000000080000000000000080000000000000000000000000000000000000000000000000000000000000000
00700700000000088800000000000008880000000000000888000000000000888000000000000000000000000000000000000000000000000000000000000000
0007700000000ff080f0000000000ff080f0000000000ff080f0000000000f080ff0000000000000000000000000000000000000000000000000000000000000
0007700000000fff484f000000000fff484f000000000fff484f00000000f484fff0000000000000088000000000088000000000000000000000000000000000
0070070000000fff484f000000000fff484f000000000fff484f00000000f484fff00000000000ff8880000000000888ff000000000000000000000000000000
0000000000000fff484f000000000f8f484f800000000f8f484f80000000f484fff0000000000fff080f00000000f080fff00000000000000000000000000000
0000000000000f8f484f800000000fff484f000000000fff484f00000008f484f8f0000000000fff888f00000000f888fff00000000000000000000000000000
0000000000000fff484f000000000fff484f000000000fff484f00000000f484fff000000000fff4888f00000000f8884fff0000000000000000000000000000
0000000000000fff484f000000000fff484f000000000fff484f00000000f484fff000000000fff4888f00000000f8884fff0000000000000000000000000000
0000000000000fff484f000000000fff484f000000000fff484f00000000f484fff000000000f848888f80000008f888848f0000000000000000000000000000
0000000000000ff488f0000000000ff488f0000000000ff488f0000000000f884ff000000000ff48884f00000000f48884ff0000000000000000000000000000
0000000000000ff888f0000000000ff888f0000000000ff888f0000000000f888ff0000000000ff888ff00000000ff888ff00000000000000000000000000000
00000000000000080800000000000080080000000000008008000000000000808000000000000008080000000000008080000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00044a000000000000000000000000000000000000000000000000000000000000000000000000000000000000a4400000000000000000000000000000000000
00000aa00000000000044aa00000000000000000000000000000000000000000000000000aa44000000000000aa0000000000000000000000000000000000000
00000aaa4000000000000aaa400000000000000000000000000000000000000000000004aaa0000000000004aaa0000000000000000000000000000000000000
00000aaaa400000000000aaaa400000000044aa000000000000000000aa440000000004aaaa000000000004aaaa0000000000000000000000000000000000000
000000aaaaa00000000000aaaaa0000000000aaa4000000000000004aaa0000000000aaaaa00000000000aaaaa00000000000000000000000000000000000000
000000acacaa0000000000acacaa0000000000aaa40000000000004aaa0000000000aacaca0000000000aacaca00000000000000000000000000000000000000
0000000a4aaa00000000000a4aaa00000000000aaaa0000000000aaaa00000000000aaa4a00000000000aaa4a000000000000000000000000000000000000000
0000000aaaaa00000000000aaaaa00000000000aaaaa00000000aaaaa00000000000aaaaa00000000000aaaaa000000000000000000000000000000000000000
0000000aaaa000000000000aaaa00000000000acacaa00000000aacaca00000000000aaaa000000000000aaaa000000000000000000000000000000000000000
000000aaaaa00000000000aaaaa00000000000aa4aaa00000000aaa4aa00000000000aaaaa00000000000aaaaa00000000000000000000000000000000000000
00000aaaaa00000000000aaaaa00000000000aaaaaa0000000000aaaaaa00000000000aaaaa00000000000aaaaa0000000000000000000000000000000000000
00004aa04000000000004aa00400000000004aa004000000000000400aa40000000000400aa40000000000040aa4000000000000000000000000000000000000
00000040400000000000000400400000000000040040000000000400400000000000040040000000000000040400000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000088000000000000008800000000000000000000000000000111000000006666666666666666000fffff0000000000000000000000000000000000000000
0000880088000000000088008800000000004444444000000000111111110000446444444444464400ffffff0000000000000000000000000000000000000000
000088888888000000008888888800000000440404400000000111aaaaa1000044644444444446440fffffff0000000000000000000000000000000000000000
0000ff0f0f0000000000ff0f0f0000000004444444440000000111aa11aa00004464444444444644fffffff80000000000000000000000000000000000000000
0000ffffff0000000000ffffff000000000444909444000000011111110a00004464444444444644ffffff080000000000000000000000000000000000000000
0000fff00f0000000000ffff00000000000444484444000000777777777000004464444444444644fffff0080000000000000000000000000000000000000000
00000ffff000000000000ff088000000000440000044000000555555755550004464444444444644808000000000000000000000000000000000000000000000
00003333330000000000333300000000000440000044000000755775557050004464444444444644008000000000000000000000000000000000000000000000
0000f3333f0000000000f3333f000000000440000044000000775555755550006777777700000000000000000000000000000000000000000000000000000000
00000333300000000000033330000000000440000044000000777777777000005666666700000000000000000000000000000000000000000000000000000000
00001111110000000000111111000000000440000044000000000777000000005666666700000000000000000000000000000000000000000000000000000000
00011100111000000001110011100000000440000044000000000070000000005666666700000000000000000000000000000000000000000000000000000000
00011100111000000001110011100000000440000044000007777777744440005666666700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000444000444000070007777744440005666666700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000444000444000007007777744447005666666700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000707777747770005555555600000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007777744440000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007777744440000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007000700000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007000700000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007000700000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007000700000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000007000700000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000777000770000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004949494949494949494949494949000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004848484848484848484848484848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004949494949494949494949494949000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004848484848484848484848484848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004949494949494949494949494949000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000004848484848484848484848484848000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000585858585858585858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000058585858585858585858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000005858585858585858585858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000005858585858585858585858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000585858585858585858585858585858585858000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
